<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Graph</title>
    <style>
        #chartdiv {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>

<body>
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/hierarchy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <div id="chartdiv"></div>

    <script>
        // Create root element
        var root = am5.Root.new("chartdiv");

        // Set themes
        root.setThemes([
            am5themes_Animated.new(root)
        ]);

        var zoomableContainer = root.container.children.push(
            am5.ZoomableContainer.new(root, {
                width: am5.p100,
                height: am5.p100,
                wheelable: true,
                pinchZoom: true
            })
        );

        var zoomTools = zoomableContainer.children.push(am5.ZoomTools.new(root, {
            target: zoomableContainer
        }));

        // Create series
        var series = zoomableContainer.contents.children.push(am5hierarchy.ForceDirected.new(root, {
            singleBranchOnly: false,
            downDepth: 1,
            initialDepth: 10,
            nodePadding: 20,
            valueField: "value",
            categoryField: "name",
            childDataField: "children"
        }));

        series.linkBullets.push(function (root, source, target) {
            const bullet = am5.Bullet.new(root, {
                locationX: 0.5,
                autoRotate: true,
                autoRotateAngle: 180,
                sprite: am5.Graphics.new(root, {
                    fill: source.get("fill"),
                    centerY: am5.percent(50),
                    centerX: am5.percent(50),
                    draw: function (display) {
                        display.moveTo(0, -6);
                        display.lineTo(16, 0);
                        display.lineTo(0, 6);
                        display.lineTo(3, 0);
                        display.lineTo(0, -6);
                    }
                })
            });

            bullet.animate({
                key: "locationX",
                to: -0.1,
                from: 1.1,
                duration: Math.random() * 500 + 1000,
                loops: Infinity,
                easing: am5.ease.quad
            });

            return bullet;
        });

        series.labels.template.set("minScale", 0);

        // Fetch data from 'product.json' file
        fetch('products.json')
            .then(response => response.json())
            .then(data => {
                series.data.setAll([data]);
                series.set("selectedDataItem", series.dataItems[0]);

                // Make stuff animate on load
                series.appear(1000, 100);
            })
            .catch(error => {
                console.error('Error loading the data:', error);
            });
    </script>
</body>

</html>
